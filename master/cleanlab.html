<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="CIFAR CNN" href="cleanlab.models.html" /><link rel="prev" title="Introduction" href="index.html" />

    <link rel="shortcut icon" href="https://raw.githubusercontent.com/cleanlab/assets/master/cleanlab/cleanlab_logo_only.png"/><meta name="generator" content="sphinx-4.4.0, furo 2022.02.23"/>
        <title>Classification - cleanlab docs</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=3c656993158f05539f962c5cea52a5e6c184bb8c" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=25ceb02ed1c46dc30f2321ff83e92799f69dfdb9" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">cleanlab docs</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="https://raw.githubusercontent.com/cleanlab/assets/master/cleanlab/cleanlab_logo_only.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">cleanlab docs</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="#latent-estimation">Latent Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-cleanlab.noise_generation">Noise Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#baseline-methods">Baseline Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-cleanlab.coteaching">Co-Teaching</a></li>
<li class="toctree-l1"><a class="reference internal" href="#latent-algebra">Latent Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="#pruning">Pruning</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-cleanlab.util">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="#polyplex">Polyplex</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="#models">Models</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="cleanlab.models.html">CIFAR CNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="cleanlab.models.html#mnist-pytorch">MNIST PyTorch</a></li>
</ul>
</li>
</ul>

</div>


<!-- Start of versioning -->

<div class="sidebar-tree">
  <p class="caption" role="heading">
    <span class="caption-text">Versions</span>
  </p>
  <ul>
    <li class="toctree-l1">
      <a
        id="version_number"
        class="reference internal"
        href="../stable/index.html"
        >stable</a
      >
    </li>
    <li class="toctree-l1">
      <a id="commit_hash" class="reference internal" href="../master/index.html"
        >developer</a
      >
    </li>
  </ul>
</div>

<script type="text/javascript" src="../versioning.js"></script>

<script type="text/javascript">
  window.onload = function () {
    var version_number = Version.version_number;
    var commit_hash = Version.commit_hash;

    document.getElementById("version_number").innerHTML =
      "stable <code class='docutils literal notranslate'><span class='pre'> (" +
      version_number +
      ")</span></code>";
    document.getElementById("commit_hash").innerHTML =
      "master <code class='docutils literal notranslate'><span class='pre'> (" +
      commit_hash.slice(0, 7) +
      "&hellip;)</span></code>";
  };
</script>

<!-- End of versioning -->

</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          


<!-- Start of Version Warning Banner -->

<p id="doc_ver_warning"></p>

<script type="text/javascript" src="../versioning.js"></script>
<script type="text/javascript">
  function genDocVerWarning() {
    var version_number = Version.version_number;
    var path_arr = window.location.pathname.split("/");

    if (path_arr.includes("master")) {
      document.getElementById("doc_ver_warning").innerHTML = `
      <div class="admonition warning">
      <p class="admonition-title">Warning</p>
      <p>This version of the documentation corresponds to the master branch of <code class="docutils literal notranslate"><span class="pre">cleanlab</span></code> source code from <a href="https://github.com/cleanlab/cleanlab/">GitHub</a>. To see the documentation for the latest <code class="docutils literal notranslate"><span class="pre">pip</span></code>-installed version, click <a href="../stable/index.html">here</a>.</p>
      </div>
      `;
    } else if (!path_arr.includes(version_number)) {
      document.getElementById("doc_ver_warning").innerHTML =
        `
        <div class="admonition warning">
        <p class="admonition-title">Warning</p>
        <p>This documentation is for an old version (<code class="docutils literal notranslate"><span class="pre">master</span></code>) of <code class="docutils literal notranslate"><span class="pre">cleanlab</span></code>. To see the documentation for the latest stable version (<code class="docutils literal notranslate"><span class="pre">` +
        version_number +
        `</span></code>), click <a href="../stable/index.html">here</a>.</p>
        </div>
      `;
    } else {
      document.getElementById("doc_ver_warning").remove();
    }
  }

  genDocVerWarning();
</script>

<!-- End of Version Warning Banner -->


<div class="section" id="module-cleanlab.classification">
<span id="classification"></span><h1>Classification<a class="headerlink" href="#module-cleanlab.classification" title="Permalink to this headline">#</a></h1>
<p>cleanlab package for multiclass, multi-label learning with noisy labels for any dataset and model.</p>
<p>The LearningWithNoisyLabels class wraps around an instance of a
classifier class. Your classifier must adhere to the sklearn template,
meaning it must define four functions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">clf.fit(X,</span> <span class="pre">y,</span> <span class="pre">sample_weight</span> <span class="pre">=</span> <span class="pre">None)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clf.predict_proba(X)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clf.predict(X)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clf.score(X,</span> <span class="pre">y,</span> <span class="pre">sample_weight</span> <span class="pre">=</span> <span class="pre">None)</span></code></p></li>
</ul>
<p>where <code class="docutils literal notranslate"><span class="pre">X</span></code> (of length <em>n</em>) contains the data/examples, <code class="docutils literal notranslate"><span class="pre">y</span></code> (of length <em>n</em>)
contains the contains targets formatted as <code class="docutils literal notranslate"><span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">...,</span> <span class="pre">K-1</span></code>, and
<code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> (of length <em>n</em>) re-weights examples in the loss function while
training.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are two new notions of confidence in this package:</p>
<p>1. Confident <strong>examples</strong> – examples we are confident are labeled correctly
We prune everything else. Comptuationally, this means keeping the examples
with high probability of belong to their provided label class.</p>
<p>2. Confident <strong>errors</strong> – examples we are confident are labeled erroneously.
We prune these. Comptuationally, this means pruning the examples with
high probability of belong to a different class.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cleanlab.classification</span> <span class="kn">import</span> <span class="n">LearningWithNoisyLabels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span> <span class="k">as</span> <span class="n">LogReg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rp</span> <span class="o">=</span> <span class="n">LearningWithNoisyLabels</span><span class="p">(</span><span class="n">clf</span><span class="o">=</span><span class="n">LogReg</span><span class="p">())</span> <span class="c1"># Pass in any classifier.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">labels_maybe_with_errors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Estimate the predictions as if you had trained without label issues.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pred</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
<p>The easiest way to use any model (Tensorflow, caffe2, PyTorch, etc.)
with <code class="docutils literal notranslate"><span class="pre">cleanlab</span></code> is to wrap it in a class that inherits
the <code class="docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">BaseEstimator</span>
<span class="k">class</span> <span class="nc">YourModel</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">):</span> <span class="c1"># Inherits sklearn base classifier</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><cite>labels</cite> - The given (maybe noisy) labels in the original dataset, which may have errors.</p></li>
<li><p>Class labels (K classes) must be formatted as natural numbers: 0, 1, …, K-1</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Confident Learning is the state-of-the-art (Northcutt et al., 2021) for
weak supervision, finding label issues in datasets, learning with noisy
labels, uncertainty estimation, and more. It works with ANY classifier,
including deep neural networks. See clf parameter.</p>
<p>Confident learning is a subfield of theory and algorithms of machine learning with noisy labels.
Cleanlab achieves state-of-the-art performance of any open-sourced implementation of confident
learning across a variety of tasks like multi-class classification, multi-label classification,
and PU learning.</p>
<p>Given any classifier having the predict_proba() method, an input feature
matrix, <cite>X</cite>, and a discrete vector of noisy labels, <cite>labels</cite>, Confident Learning estimates the
classifications that would be obtained if the <cite>true_labels</cite> had instead been provided
to the classifier during training. <cite>labels</cite> denotes the noisy label instead of
tilde(y) (used in confident learning paper), for ASCII encoding reasons.</p>
</div>
<p><strong>Classes:</strong></p>
<div class="table-wrapper"><table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.classification.LearningWithNoisyLabels" title="cleanlab.classification.LearningWithNoisyLabels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LearningWithNoisyLabels</span></code></a>([clf, seed, ...])</p></td>
<td><p>Automated and robust learning with noisy labels using any dataset and any model.</p></td>
</tr>
</tbody>
</table></div>
<dl class="py class">
<dt class="sig sig-object py" id="cleanlab.classification.LearningWithNoisyLabels">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cleanlab.classification.</span></span><span class="sig-name descname"><span class="pre">LearningWithNoisyLabels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_n_folds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prune_by_noise_rate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">converge_latent_estimates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pulearning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/classification.html#LearningWithNoisyLabels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.classification.LearningWithNoisyLabels" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code></p>
<p>Automated and robust learning with noisy labels using any dataset and any model. This class
trains a model <cite>clf</cite> with error-prone, noisy labels as if the model had been instead trained
on a dataset with perfect labels. It achieves this by cleaning out the error and providing
cleaned data while training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clf</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn.classifier</span></code> compliant class (e.g. skorch wraps around PyTorch)) – See cleanlab.example_models for examples of sklearn wrappers around, e.g. PyTorch.
The clf object must have the following three functions defined:
1. clf.predict_proba(X) # Predicted probabilities
2. clf.predict(X) # Predict labels
3. clf.fit(X, y, sample_weight) # Train classifier
Stores the classifier used in Confident Learning.
Default classifier used is logistic regression.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, <em>default</em>: <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>) – Set the default state of the random number generator used to split
the cross-validated folds. If None, uses np.random current random state.</p></li>
<li><p><strong>cv_n_folds</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – This class needs holdout predicted probabilities for every data example
and if not provided, uses cross-validation to compute them.
cv_n_folds sets the number of cross-validation folds used to compute
out-of-sample probabilities for each example in X.</p></li>
<li><p><strong>filter_by</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, <em>default</em>: <code class="docutils literal notranslate"><span class="pre">'prune_by_noise_rate'</span></code>) – <dl class="simple">
<dt>Possible Values: {‘prune_by_class’, ‘prune_by_noise_rate’, ‘both’,</dt><dd><p>’confident_learning’, ‘predicted_neq_given’}</p>
</dd>
</dl>
<p>Determines the method used to filter label issues.</p>
<p>1. <code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by=prune_by_noise_rate</span></code>: works by removing examples with
<em>high probability</em> of being mislabeled for every non-diagonal in the confident joint
(see <cite>prune_counts_matrix</cite> in <cite>filter.py</cite>). These are the examples where (with high
confidence) the given label is unlikely to match the predicted label.</p>
<p>2. <code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by=prune_by_class</span></code>: works by removing the examples with
<em>smallest probability</em> of belonging to their given class label for every class.</p>
<p>3. <code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by=both</span></code>: Finds the examples satisfying (1) AND (2)
and removes their set conjunction.</p>
<p>4. <code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by=confident_learning</span></code>: Find examples that are confidently
labeled as a different class from their given label while computing the confident joint.</p>
<p>5. <code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by=predicted_neq_given</span></code>: Find examples where the argmax prediction
does not match the given label.</p>
</p></li>
<li><p><strong>converge_latent_estimates</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code> (Default: <code class="xref py py-class docutils literal notranslate"><span class="pre">False)</span></code>) – If true, forces numerical consistency of latent estimates. Each is
estimated independently, but they are related mathematically with closed
form equivalences. This will iteratively enforce consistency.</p></li>
<li><p><strong>pulearning</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code> (0 or <code class="docutils literal notranslate"><span class="pre">1</span></code>, <em>default</em>: <code class="xref py py-class docutils literal notranslate"><span class="pre">None)</span></code>) – Only works for 2 class datasets. Set to the integer of the class that is
perfectly labeled (certain no errors in that class).</p></li>
<li><p><strong>n_jobs</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code> (Windows users may see a speed-up with n_jobs = 1)) – Number of processing threads used by multiprocessing. Default None
sets to the number of processing threads on your CPU.
Set this to 1 to REMOVE parallel processing (if it’s causing issues).</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods:</strong></p>
<div class="table-wrapper"><table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.classification.LearningWithNoisyLabels.fit" title="cleanlab.classification.LearningWithNoisyLabels.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(X, labels, *[, pred_probs, thresholds, ...])</p></td>
<td><p>This method trains the model <cite>self.clf</cite> with error-prone, noisy labels as if the model had been instead trained on a dataset with perfect labels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.classification.LearningWithNoisyLabels.get_label_issues" title="cleanlab.classification.LearningWithNoisyLabels.get_label_issues"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_label_issues</span></code></a>()</p></td>
<td><p>Accessor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.classification.LearningWithNoisyLabels.get_params" title="cleanlab.classification.LearningWithNoisyLabels.get_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code></a>([deep])</p></td>
<td><p>Get parameters for this estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.classification.LearningWithNoisyLabels.predict" title="cleanlab.classification.LearningWithNoisyLabels.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(*args, **kwargs)</p></td>
<td><p>Returns a vector of predictions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.classification.LearningWithNoisyLabels.predict_proba" title="cleanlab.classification.LearningWithNoisyLabels.predict_proba"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_proba</span></code></a>(*args, **kwargs)</p></td>
<td><p>Returns a vector of probabilities P(true_label=k) for each example in X.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.classification.LearningWithNoisyLabels.score" title="cleanlab.classification.LearningWithNoisyLabels.score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score</span></code></a>(X, y[, sample_weight])</p></td>
<td><p>Returns the clf's score on a test set X with labels y.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.classification.LearningWithNoisyLabels.set_params" title="cleanlab.classification.LearningWithNoisyLabels.set_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code></a>(**params)</p></td>
<td><p>Set the parameters of this estimator.</p></td>
</tr>
</tbody>
</table></div>
<dl class="py method">
<dt class="sig sig-object py" id="cleanlab.classification.LearningWithNoisyLabels.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_noise_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/classification.html#LearningWithNoisyLabels.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.classification.LearningWithNoisyLabels.fit" title="Permalink to this definition">#</a></dt>
<dd><p>This method trains the model <cite>self.clf</cite> with error-prone, noisy labels as if
the model had been instead trained on a dataset with perfect labels.
It achieves this by cleaning out the error and providing cleaned data while training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>) – Input feature matrix (N, D), 2D numpy array</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>) – A discrete vector of noisy labels, i.e. some labels may be erroneous.
<em>Format requirements</em>: for dataset with K classes, labels must be in {0,1,…,K-1}.</p></li>
<li><p><strong>pred_probs</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code> (shape (N, <code class="xref py py-class docutils literal notranslate"><span class="pre">K))</span></code>) – </p></li>
<li><p><strong>probabilities.</strong> (<em>P</em><em>(</em><em>label=k</em><em>|</em><em>x</em><em>) </em><em>is a matrix with K model-predicted</em>) – </p></li>
<li><p><strong>model-predicted</strong> (<em>Each row of this matrix corresponds to an example x and contains the</em>) – </p></li>
<li><p><strong>class.</strong> (<em>probabilities that x belongs to each possible</em>) – </p></li>
<li><p><strong>0</strong> (<em>The columns must be ordered such that these probabilities correspond to class</em>) – </p></li>
<li><p><strong>1</strong> – </p></li>
<li><p><strong>2</strong> – </p></li>
<li><p><strong>...</strong> – </p></li>
<li><p><strong>cross-validation.</strong> (<em>pred_probs should have been computed using 3</em><em> (or </em><em>higher</em><em>) </em><em>fold</em>) – <div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are not sure, leave <cite>pred_probs = None</cite> (default) and it will be computed for you using
cross-validation with your model.</p>
</div>
</p></li>
<li><p><strong>thresholds</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">iterable</span></code> (list or <code class="xref py py-class docutils literal notranslate"><span class="pre">np.array)</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(K</span></code>, 1)  or <code class="xref py py-class docutils literal notranslate"><span class="pre">(K,)</span></code>) – P(label^=k|label=k). List of probabilities used to determine the cutoff
predicted probability necessary to consider an example as a given
class label.
Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>. These are computed for you automatically.
If an example has a predicted probability “greater” than
this threshold, it is counted as having true_label = k. This is
not used for pruning/filtering, only for estimating the noise rates using
confident counts. Values in list should be between 0 and 1.</p></li>
<li><p><strong>noise_matrix</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(K</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">K)</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">K</span> <span class="pre">=</span> <span class="pre">number</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">classes</span></code>) – A conditional probability matrix of the form P(label=k_s|true_label=k_y) containing
the fraction of examples in every class, labeled as every other class.
Assumes columns of noise_matrix sum to 1.</p></li>
<li><p><strong>inverse_noise_matrix</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(K</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">K)</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">K</span> <span class="pre">=</span> <span class="pre">number</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">classes</span></code>) – A conditional probability matrix of the form P(true_label=k_y|label=k_s). Contains
the estimated fraction observed examples in each class k_s, that are
mislabeled examples from every other class k_y. If None, the
inverse_noise_matrix will be computed from pred_probs and labels.
Assumes columns of inverse_noise_matrix sum to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(label_issues_mask, sample_weight)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="cleanlab.classification.LearningWithNoisyLabels.get_label_issues">
<span class="sig-name descname"><span class="pre">get_label_issues</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/classification.html#LearningWithNoisyLabels.get_label_issues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.classification.LearningWithNoisyLabels.get_label_issues" title="Permalink to this definition">#</a></dt>
<dd><p>Accessor. Returns <cite>self.label_issues_mask</cite> computed via <cite>filter.find_label_issues()</cite></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="cleanlab.classification.LearningWithNoisyLabels.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cleanlab.classification.LearningWithNoisyLabels.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>deep</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>default</em> <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>) – If True, will return the parameters for this estimator and
contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="cleanlab.classification.LearningWithNoisyLabels.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/classification.html#LearningWithNoisyLabels.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.classification.LearningWithNoisyLabels.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a vector of predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(n</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">m)</span></code>) – The test data as a feature matrix.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="cleanlab.classification.LearningWithNoisyLabels.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/classification.html#LearningWithNoisyLabels.predict_proba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.classification.LearningWithNoisyLabels.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a vector of probabilities P(true_label=k)
for each example in X.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(n</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">m)</span></code>) – The test data as a feature matrix.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="cleanlab.classification.LearningWithNoisyLabels.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/classification.html#LearningWithNoisyLabels.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.classification.LearningWithNoisyLabels.score" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the clf’s score on a test set X with labels y.
Uses the model/clf’s default scoring function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(n</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">m)</span></code>) – The test data as a feature matrix.</p></li>
<li><p><strong>y</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(n,)</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">(n</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">1)</span></code>) – The test classification labels as an array.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(n,)</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">(n</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">1)</span></code>) – Weights each example when computing the score / accuracy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="cleanlab.classification.LearningWithNoisyLabels.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cleanlab.classification.LearningWithNoisyLabels.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as <code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code>). The latter have
parameters of the form <code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s
possible to update each component of a nested object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">instance</span></code></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="latent-estimation">
<h1>Latent Estimation<a class="headerlink" href="#latent-estimation" title="Permalink to this headline">#</a></h1>
</div>
<div class="section" id="module-cleanlab.noise_generation">
<span id="noise-generation"></span><h1>Noise Generation<a class="headerlink" href="#module-cleanlab.noise_generation" title="Permalink to this headline">#</a></h1>
<p><strong>Functions:</strong></p>
<div class="table-wrapper"><table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.noise_generation.generate_n_rand_probabilities_that_sum_to_m" title="cleanlab.noise_generation.generate_n_rand_probabilities_that_sum_to_m"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_n_rand_probabilities_that_sum_to_m</span></code></a>(n, m, *)</p></td>
<td><p>When min_prob=0 and max_prob = 1.0, this method is deprecated.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.noise_generation.generate_noise_matrix" title="cleanlab.noise_generation.generate_noise_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_noise_matrix</span></code></a>(K, *[, ...])</p></td>
<td><p>DEPRECATED - Use generate_noise_matrix_from_trace()</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.noise_generation.generate_noise_matrix_from_trace" title="cleanlab.noise_generation.generate_noise_matrix_from_trace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_noise_matrix_from_trace</span></code></a>(K, trace, *)</p></td>
<td><p>Generates a K x K noise matrix P(label=k_s|true_label=k_y) with trace as the np.mean(np.diagonal(noise_matrix)).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.noise_generation.generate_noisy_labels" title="cleanlab.noise_generation.generate_noisy_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_noisy_labels</span></code></a>(true_labels, noise_matrix)</p></td>
<td><p>Generates noisy labels (shape (N, 1)) from perfect labels y, 'exactly' yielding the provided noise_matrix between labels and y.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.noise_generation.noise_matrix_is_valid" title="cleanlab.noise_generation.noise_matrix_is_valid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">noise_matrix_is_valid</span></code></a>(noise_matrix, py, *[, ...])</p></td>
<td><p>Given a prior py = p(true_label=k), returns true if the given noise_matrix is a learnable matrix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.noise_generation.randomly_distribute_N_balls_into_K_bins" title="cleanlab.noise_generation.randomly_distribute_N_balls_into_K_bins"><code class="xref py py-obj docutils literal notranslate"><span class="pre">randomly_distribute_N_balls_into_K_bins</span></code></a>(N, K, *)</p></td>
<td><p>Returns a uniformly random numpy integer array of length N that sums to K.</p></td>
</tr>
</tbody>
</table></div>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.noise_generation.generate_n_rand_probabilities_that_sum_to_m">
<span class="sig-prename descclassname"><span class="pre">cleanlab.noise_generation.</span></span><span class="sig-name descname"><span class="pre">generate_n_rand_probabilities_that_sum_to_m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/noise_generation.html#generate_n_rand_probabilities_that_sum_to_m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.noise_generation.generate_n_rand_probabilities_that_sum_to_m" title="Permalink to this definition">#</a></dt>
<dd><p>When min_prob=0 and max_prob = 1.0, this method is deprecated.
Instead use np.random.dirichlet(np.ones(n))*m</p>
<p>Generates ‘n’ random probabilities that sum to ‘m’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Length of np.array of random probabilities to be returned.</p></li>
<li><p><strong>m</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Sum of np.array of random probabilities that is returned.</p></li>
<li><p><strong>max_prob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">(0.0</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">1.0]</span> <span class="pre">|</span> <span class="pre">Default</span> <span class="pre">value</span> <span class="pre">is</span> <span class="pre">1.0</span></code>) – Maximum probability of any entry in the returned np.array.</p></li>
<li><p><strong>min_prob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">[0.0</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">1.0)</span> <span class="pre">|</span> <span class="pre">Default</span> <span class="pre">value</span> <span class="pre">is</span> <span class="pre">0.0</span></code>) – Minimum probability of any entry in the returned np.array.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.noise_generation.generate_noise_matrix">
<span class="sig-prename descclassname"><span class="pre">cleanlab.noise_generation.</span></span><span class="sig-name descname"><span class="pre">generate_noise_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_noise_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_zero_noise_rates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/noise_generation.html#generate_noise_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.noise_generation.generate_noise_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>DEPRECATED - Use generate_noise_matrix_from_trace()</p>
<p>Generates a noise matrix by randomly assigning noise rates
up to max_noise_rate, then setting noise rates to
zero until P(label!=k|label=k) &lt; 1 is satisfied. Additionally,
frac_zero_noise_rates are set to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>K</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Creates a noise matrix of shape (K, K). Implies there are
K classes for learning with noisy labels.</p></li>
<li><p><strong>max_noise_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Smaller —&gt; easier learning problem (less noise)</p></li>
<li><p><strong>frac_zero_noise_rates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Make problem more tractable by making a fraction of noise rates zero.
Larger –&gt; Easier learning problem</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Print debugging output if set to True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.noise_generation.generate_noise_matrix_from_trace">
<span class="sig-prename descclassname"><span class="pre">cleanlab.noise_generation.</span></span><span class="sig-name descname"><span class="pre">generate_noise_matrix_from_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_trace_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_trace_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_noise_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_noise_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_noise_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_zero_noise_rates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/noise_generation.html#generate_noise_matrix_from_trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.noise_generation.generate_noise_matrix_from_trace" title="Permalink to this definition">#</a></dt>
<dd><p>Generates a K x K noise matrix P(label=k_s|true_label=k_y) with trace
as the np.mean(np.diagonal(noise_matrix)).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>K</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Creates a noise matrix of shape (K, K). Implies there are
K classes for learning with noisy labels.</p></li>
<li><p><strong>trace</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">(0.0</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">1.0]</span></code>) – Sum of diagonal entries of np.array of random probabilities returned.</p></li>
<li><p><strong>max_trace_prob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">(0.0</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">1.0]</span></code>) – Maximum probability of any entry in the trace of the return matrix.</p></li>
<li><p><strong>min_trace_prob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">[0.0</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">1.0)</span></code>) – Minimum probability of any entry in the trace of the return matrix.</p></li>
<li><p><strong>max_noise_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">(0.0</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">1.0]</span></code>) – Maximum noise_rate (non-diagonal entry) in the returned np.array.</p></li>
<li><p><strong>min_noise_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">[0.0</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">1.0)</span></code>) – Minimum noise_rate (non-diagonal entry) in the returned np.array.</p></li>
<li><p><strong>valid_noise_matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, returns a matrix having all necessary conditions for
learning with noisy labels. In particular, p(true_label=k)p(label=k) &lt; p(true_label=k,label=k)
is satisfied. This requires that Trace &gt; 1.</p></li>
<li><p><strong>py</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.array</span> <span class="pre">(shape</span> <span class="pre">(K</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">1))</span></code>) – Fraction (prior probability) of each true class label, P(true_label = k).
REQUIRED when valid_noise_matrix == True.</p></li>
<li><p><strong>frac_zero_noise_rates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The fraction of the n*(n-1) noise rates
that will be set to 0. Note that if you set a high trace, it may be
impossible to also have a low fraction of zero noise rates without
forcing all non-“1” diagonal values. Instead, when this happens we only
guarantee to produce a noise matrix with frac_zero_noise_rates <strong>or
higher</strong>. The opposite occurs with a small trace.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Seeds the random number generator for numpy.</p></li>
<li><p><strong>max_iter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span> <span class="pre">(default</span></code>: <code class="xref py py-class docutils literal notranslate"><span class="pre">10000)</span></code>) – The max number of tries to produce a valid matrix before returning False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>noise matrix P(label=k_s|true_label=k_y) with trace
as the np.sum(np.diagonal(noise_matrix)).
This a conditional probability matrix and a
left stochastic matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.array</span> <span class="pre">(shape</span> <span class="pre">(K</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">K))</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.noise_generation.generate_noisy_labels">
<span class="sig-prename descclassname"><span class="pre">cleanlab.noise_generation.</span></span><span class="sig-name descname"><span class="pre">generate_noisy_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/noise_generation.html#generate_noisy_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.noise_generation.generate_noisy_labels" title="Permalink to this definition">#</a></dt>
<dd><p>Generates noisy labels (shape (N, 1)) from perfect labels y,
‘exactly’ yielding the provided noise_matrix between labels and y.</p>
<p>Below we provide a for loop implementation of what this function does.
We do not use this implementation as it is not a fast algorithm, but
it explains as Python pseudocode what is happening in this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>true_labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.array</span> <span class="pre">(shape</span> <span class="pre">(N</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">1))</span></code>) – Perfect labels, without any noise. Contains K distinct natural number
classes, e.g. 0, 1,…, K-1</p></li>
<li><p><strong>noise_matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.array</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(K</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">K)</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">K</span> <span class="pre">=</span> <span class="pre">number</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">classes</span></code>) – A conditional probability matrix of the form P(label=k_s|true_label=k_y) containing
the fraction of examples in every class, labeled as every other class.
Assumes columns of noise_matrix sum to 1.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate labels</span>
<span class="n">count_joint</span> <span class="o">=</span> <span class="p">(</span><span class="n">noise_matrix</span> <span class="o">*</span> <span class="n">py</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k_s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k_y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">k_s</span> <span class="o">!=</span> <span class="n">k_y</span><span class="p">:</span>
            <span class="n">idx_flip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">labels</span><span class="o">==</span><span class="n">k_y</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">true_label</span><span class="o">==</span><span class="n">k_y</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_flip</span><span class="p">):</span> <span class="c1"># pragma: no cover</span>
                <span class="n">labels</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="n">idx_flip</span><span class="p">,</span>
                    <span class="n">count_joint</span><span class="p">[</span><span class="n">k_s</span><span class="p">][</span><span class="n">k_y</span><span class="p">],</span>
                    <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)]</span> <span class="o">=</span> <span class="n">k_s</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.noise_generation.noise_matrix_is_valid">
<span class="sig-prename descclassname"><span class="pre">cleanlab.noise_generation.</span></span><span class="sig-name descname"><span class="pre">noise_matrix_is_valid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/noise_generation.html#noise_matrix_is_valid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.noise_generation.noise_matrix_is_valid" title="Permalink to this definition">#</a></dt>
<dd><p>Given a prior py = p(true_label=k), returns true if the given noise_matrix is a
learnable matrix. Learnability means that it is possible to achieve
better than random performance, on average, for the amount of noise in
noise_matrix.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.noise_generation.randomly_distribute_N_balls_into_K_bins">
<span class="sig-prename descclassname"><span class="pre">cleanlab.noise_generation.</span></span><span class="sig-name descname"><span class="pre">randomly_distribute_N_balls_into_K_bins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_balls_per_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_balls_per_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/noise_generation.html#randomly_distribute_N_balls_into_K_bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.noise_generation.randomly_distribute_N_balls_into_K_bins" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a uniformly random numpy integer array of length N that sums
to K.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – </p></li>
<li><p><strong>K</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – </p></li>
<li><p><strong>max_balls_per_bin</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – </p></li>
<li><p><strong>min_balls_per_bin</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
</div>
<div class="section" id="baseline-methods">
<h1>Baseline Methods<a class="headerlink" href="#baseline-methods" title="Permalink to this headline">#</a></h1>
</div>
<div class="section" id="module-cleanlab.coteaching">
<span id="co-teaching"></span><h1>Co-Teaching<a class="headerlink" href="#module-cleanlab.coteaching" title="Permalink to this headline">#</a></h1>
<p><strong>Functions:</strong></p>
<div class="table-wrapper"><table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.coteaching.adjust_learning_rate" title="cleanlab.coteaching.adjust_learning_rate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">adjust_learning_rate</span></code></a>(optimizer, epoch, ...)</p></td>
<td><p>Scheduler to adjust learning rate and betas for Adam Optimizer</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.coteaching.evaluate" title="cleanlab.coteaching.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a>(test_loader, model1, model2)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.coteaching.forget_rate_scheduler" title="cleanlab.coteaching.forget_rate_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forget_rate_scheduler</span></code></a>(epochs, forget_rate, ...)</p></td>
<td><p>Tells Co-Teaching what fraction of examples to forget at each epoch.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.coteaching.initialize_lr_scheduler" title="cleanlab.coteaching.initialize_lr_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_lr_scheduler</span></code></a>([lr, epochs, ...])</p></td>
<td><p>Scheduler to adjust learning rate and betas for Adam Optimizer</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.coteaching.loss_coteaching" title="cleanlab.coteaching.loss_coteaching"><code class="xref py py-obj docutils literal notranslate"><span class="pre">loss_coteaching</span></code></a>(y_1, y_2, t, forget_rate[, ...])</p></td>
<td><p>Co-Teaching Loss function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.coteaching.train" title="cleanlab.coteaching.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>(train_loader, epoch, model1, ...)</p></td>
<td><p>PyTorch training function.</p></td>
</tr>
</tbody>
</table></div>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.coteaching.adjust_learning_rate">
<span class="sig-prename descclassname"><span class="pre">cleanlab.coteaching.</span></span><span class="sig-name descname"><span class="pre">adjust_learning_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_plan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta1_plan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/coteaching.html#adjust_learning_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.coteaching.adjust_learning_rate" title="Permalink to this definition">#</a></dt>
<dd><p>Scheduler to adjust learning rate and betas for Adam Optimizer</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.coteaching.evaluate">
<span class="sig-prename descclassname"><span class="pre">cleanlab.coteaching.</span></span><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/coteaching.html#evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.coteaching.evaluate" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.coteaching.forget_rate_scheduler">
<span class="sig-prename descclassname"><span class="pre">cleanlab.coteaching.</span></span><span class="sig-name descname"><span class="pre">forget_rate_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forget_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gradual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/coteaching.html#forget_rate_scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.coteaching.forget_rate_scheduler" title="Permalink to this definition">#</a></dt>
<dd><p>Tells Co-Teaching what fraction of examples to forget at each epoch.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.coteaching.initialize_lr_scheduler">
<span class="sig-prename descclassname"><span class="pre">cleanlab.coteaching.</span></span><span class="sig-name descname"><span class="pre">initialize_lr_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_decay_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/coteaching.html#initialize_lr_scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.coteaching.initialize_lr_scheduler" title="Permalink to this definition">#</a></dt>
<dd><p>Scheduler to adjust learning rate and betas for Adam Optimizer</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.coteaching.loss_coteaching">
<span class="sig-prename descclassname"><span class="pre">cleanlab.coteaching.</span></span><span class="sig-name descname"><span class="pre">loss_coteaching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forget_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/coteaching.html#loss_coteaching"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.coteaching.loss_coteaching" title="Permalink to this definition">#</a></dt>
<dd><p>Co-Teaching Loss function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span> <span class="pre">array</span></code>) – Output logits from model 1</p></li>
<li><p><strong>y_2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span> <span class="pre">array</span></code>) – Output logits from model 2</p></li>
<li><p><strong>t</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.array</span></code>) – List of Noisy Labels (t means targets)</p></li>
<li><p><strong>forget_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Decimal between 0 and 1 for how quickly the models forget what they learn.
Just use rate_schedule[epoch] for this value</p></li>
<li><p><strong>class_weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span> <span class="pre">array</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(Number</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">classes</span> <span class="pre">x</span> <span class="pre">1)</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Default</span></code>: <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>) – A np.torch.tensor list of length number of classes with weights</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.coteaching.train">
<span class="sig-prename descclassname"><span class="pre">cleanlab.coteaching.</span></span><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forget_rate_schedule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cleanlab/coteaching.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.coteaching.train" title="Permalink to this definition">#</a></dt>
<dd><p>PyTorch training function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loader</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code>) – </p></li>
<li><p><strong>epoch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – </p></li>
<li><p><strong>model1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">PyTorch</span> <span class="pre">class</span> <span class="pre">inheriting</span> <span class="pre">nn.Module</span></code>) – Must define __init__ and forward(self, x,)</p></li>
<li><p><strong>optimizer1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">PyTorch</span> <span class="pre">torch.optim.Adam</span></code>) – </p></li>
<li><p><strong>model2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">PyTorch</span> <span class="pre">class</span> <span class="pre">inheriting</span> <span class="pre">nn.Module</span></code>) – Must define __init__ and forward(self, x,)</p></li>
<li><p><strong>optimizer2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">PyTorch</span> <span class="pre">torch.optim.Adam</span></code>) – </p></li>
<li><p><strong>args</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">parser.parse_args()</span> <span class="pre">object</span></code>) – Must contain num_iter_per_epoch, print_freq, and epochs</p></li>
<li><p><strong>forget_rate_schedule</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.array</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">length</span> <span class="pre">number</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">epochs</span></code>) – Tells Co-Teaching loss what fraction of examples to forget about.</p></li>
<li><p><strong>class_weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span> <span class="pre">array</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(Number</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">classes</span> <span class="pre">x</span> <span class="pre">1)</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Default</span></code>: <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>) – A np.torch.tensor list of length number of classes with weights</p></li>
<li><p><strong>accuracy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">function</span></code>) – A function of the form accuracy(output, target, topk=(1,)) for
computing top1 and top5 accuracy given output and true targets.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</div>
<div class="section" id="latent-algebra">
<h1>Latent Algebra<a class="headerlink" href="#latent-algebra" title="Permalink to this headline">#</a></h1>
</div>
<div class="section" id="pruning">
<h1>Pruning<a class="headerlink" href="#pruning" title="Permalink to this headline">#</a></h1>
</div>
<div class="section" id="module-cleanlab.util">
<span id="utilities"></span><h1>Utilities<a class="headerlink" href="#module-cleanlab.util" title="Permalink to this headline">#</a></h1>
</div>
<div class="section" id="polyplex">
<h1>Polyplex<a class="headerlink" href="#polyplex" title="Permalink to this headline">#</a></h1>
</div>
<div class="section" id="models">
<h1>Models<a class="headerlink" href="#models" title="Permalink to this headline">#</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="cleanlab.models.html">CIFAR CNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="cleanlab.models.html#mnist-pytorch">MNIST PyTorch</a></li>
</ul>
</div>
</div>
 

        </article>
      </div>
      <footer>
        

        <div class="related-pages">
          <a class="next-page" href="cleanlab.models.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">CIFAR CNN</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Cleanlab Inc.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/cleanlab/cleanlab" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
         
<script type="text/javascript">
  function genPypiMsg() {
    var d1 = document.getElementsByClassName("left-details");
    console.log(d1[0])
    d1[0].insertAdjacentHTML('afterbegin', '<code class="docutils literal notranslate"><span class="pre">cleanlab</span></code> is distributed on <a href="https://pypi.org/project/cleanlab/">PyPI</a> and <a href="https://anaconda.org/conda-forge/cleanlab">conda</a>.');
  }

  genPypiMsg()
</script>


      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>